name: Setup Apigee Hybrid Dependencies

on:
 workflow_dispatch:


jobs:
  Install-Pre-requisite:
    runs-on: ubuntu-latest
    steps:
      # - name: Checkout Repository
      #   uses: actions/checkout@v4

      - name: Install Required Packages
        run: |
          sudo apt update && sudo apt install -y \
            git \
            curl \
            telnet \
            python3 \
            python3-pip

      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Install AWS CLI
        uses: unfor19/install-aws-cli-action@v1
        with:
          version: 2
      - name: Install Google Cloud SDK
        uses: google-github-actions/setup-gcloud@v1
        with:
          version: latest

      - name: Install Docker
        uses: docker/setup-buildx-action@v3

      - name: Install kubectl
        uses: azure/setup-kubectl@v3
        with:
          version: 'v1.29.0'

      - name: Install eksctl
        run: |
          curl -sL "https://github.com/weaveworks/eksctl/releases/latest/download/eksctl_Linux_amd64.tar.gz" | tar xz
          sudo mv eksctl /usr/local/bin/

      - name: Install Helm
        uses: azure/setup-helm@v3
        with:
          version: v3.16.2

      - name: Install Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: latest

      - name: Install Ansible
        run: |
          python3 -m pip install --user ansible

  Pre-requisite-Version-Check:
    runs-on: ubuntu-latest
    needs: Install-Pre-requisite
    steps:
      - name: Verify Installed Versions
        run: |
          echo "Git Version: $(git --version)"
          echo ""

          echo "Docker Version: $(docker --version)"
          echo ""

          echo "Google Cloud SDK Version: $(gcloud --version)"
          echo ""

          echo "AWS CLI Version: $(aws --version)"
          echo ""

          echo "kubectl Version: $(kubectl version --client=true --output=json | jq -r '.clientVersion.gitVersion')"
          echo ""

          echo "eksctl Version: $(eksctl version)"
          echo ""

          echo "Helm Version: $(helm version --short)"
          echo ""

          echo "Terraform Version: $(terraform version | head -n1)"
          echo ""

          echo "Ansible Version: $(ansible --version | head -n1)"
          echo ""

          echo "Telnet Installed: $(command -v telnet >/dev/null 2>&1 && echo 'Yes' || echo 'No')"
          echo ""

          echo "Python3 Version: $(python3 --version)"

   






